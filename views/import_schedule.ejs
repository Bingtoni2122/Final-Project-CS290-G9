<%#
// ÈÄôÂÄãÊ®°ÊùøÁî®ÊñºÈ°ØÁ§∫ "Import Schedule Data" ÁöÑÂΩàÂá∫Ë¶ñÁ™óÔºàModalÔºâ„ÄÇ
// ‰øÆÊ≠£ÈªûÔºöÁµ±‰∏ÄÈ°ûÂà•ÂêçÁ®±Âíå IDÔºå‰∏¶Á¢∫‰øùÈ†êË®≠Èö±Ëóè„ÄÇ
%>

<%# ‰øÆÊ≠£ 1 & 2: È°ûÂà•Âæû modal-backdrop ÊîπÁÇ∫ modal-overlayÔºåID Âæû importModalBackdrop ÊîπÁÇ∫ importModal %>
<div class="modal-overlay" id="importModal" style="display: none;"> 
    <div class="modal-content">
        <header class="modal-header">
            <h2>Import Schedule Data</h2>
            <p>Paste your exported schedule data from W2W or OSU systems</p>
            <%# ‰øÆÊ≠£ 3: ÈóúÈñâÊåâÈàïÈ°ûÂà•Âæû close-modal ÊîπÁÇ∫ close-button %>
            <button class="close-button" onclick="closeImportModal()">
                <i class="icon">√ó</i> 
            </button>
        </header>

        <div class="tabs-container">
            <%# Tabs for selecting data source %>
            <div class="import-tabs">
                <button class="import-tab active" data-source="w2w">
                    <i class="icon">üìÇ</i> W2W Schedule
                </button>
                <button class="import-tab" data-source="osu">
                    <i class="icon">üè´</i> OSU Timetable
                </button>
            </div>

            <%# Content area for the selected tab %>
            <div class="tab-content w2w-content active" id="w2wContent">
                <%# ... W2W Form ÂÖßÂÆπ‰øùÊåÅ‰∏çËÆä ... %>
                <form id="w2wImportForm" action="/import-w2w" method="POST">
                    <label for="w2wData">W2W Work Schedule Data</label>
                    <textarea 
                        id="w2wData" 
                        name="scheduleData" 
                        rows="6" 
                        placeholder="Paste W2W schedule data here... Format: Day, Start Time, End Time, Position, Location Example: Monday, 14:00, 18:00, Front Desk, Thompson Library Wednesday, 14:00, 18:00, Front Desk, Thompson Library"
                    ></textarea>

                    <div class="format-info">
                        <label>
                            <i class="icon">‚ìò</i> Format:
                        </label>
                        <p class="format-tip">
                            Day, Start Time (HH:MM), End Time (HH:MM), Position, Location 
                        </p>
                    </div>
                </form>
            </div>

            <div class="tab-content osu-content" id="osuContent" style="display:none;">
                <%# ... OSU Form ÂÖßÂÆπ‰øùÊåÅ‰∏çËÆä ... %>
                <form id="osuImportForm" action="/import-osu" method="POST">
                    <label for="osuData">OSU Class Timetable Data</label>
                    <textarea 
                        id="osuData" 
                        name="scheduleData" 
                        rows="6" 
                        placeholder="Paste OSU timetable data here... Format: Day, Course, Start Time, End Time, Location Example: Tuesday, CS290, 14:00, 15:50, Baker Hall 150"
                    ></textarea>

                    <div class="format-info">
                        <label>
                            <i class="icon">‚ìò</i> Format:
                        </label>
                        <p class="format-tip">
                            Day, Course Name, Start Time (HH:MM), End Time (HH:MM), Location
                        </p>
                    </div>
                </form>
            </div>
        </div>

        <footer class="modal-footer">
            <button class="btn-cancel" onclick="closeImportModal()">Cancel</button>
            <button class="btn-primary" onclick="submitImportForm()">Import Schedule</button>
        </footer>
    </div>
</div>

<script>
    // --- Modal ÊéßÂà∂ÂáΩÊï∏ ---
    function openImportModal() {
        // ‰øÆÊ≠£ 2: ‰ΩøÁî®Êñ∞ÁöÑ ID 'importModal'
        document.getElementById('importModal').style.display = 'flex';
    }

    function closeImportModal() {
        // ‰øÆÊ≠£ 2: ‰ΩøÁî®Êñ∞ÁöÑ ID 'importModal'
        document.getElementById('importModal').style.display = 'none';
    }

    // Tab ÂàáÊèõÈÇèËºØ (‰øùÊåÅ‰∏çËÆäÔºåÂõ†ÁÇ∫ÈÇèËºØÊòØÊ≠£Á¢∫ÁöÑ)
    document.querySelectorAll('.import-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            // ÁßªÈô§ÊâÄÊúâ tab ÁöÑ active ÁãÄÊÖã
            document.querySelectorAll('.import-tab').forEach(t => t.classList.remove('active'));
            // Ë®≠ÁΩÆÁï∂Ââç tab ÁÇ∫ active
            this.classList.add('active');

            const source = this.getAttribute('data-source');
            
            // Èö±ËóèÊâÄÊúâÂÖßÂÆπÔºåÈ°ØÁ§∫Áï∂Ââç tab ÁöÑÂÖßÂÆπ
            document.querySelectorAll('.tab-content').forEach(content => content.style.display = 'none');
            document.getElementById(source + 'Content').style.display = 'block';
        });
    });

    // Êèê‰∫§ÈÇèËºØ (‰øùÊåÅ‰∏çËÆä)
    function submitImportForm() {
        const activeTab = document.querySelector('.import-tab.active');
        if (!activeTab) return;

        const source = activeTab.getAttribute('data-source');
        
        if (source === 'w2w') {
            document.getElementById('w2wImportForm').submit();
        } else if (source === 'osu') {
            document.getElementById('osuImportForm').submit();
        }
    }
</script>
